extends layout/authorized_main

block authorized_content
    .ui.grid
        .two.column.large.screen.only.row
            .column
                h3.ui.header= "Stan-up settings"
                form.ui.form(method='post')
                    .field
                        label= 'Days'
                        div
                            .ui.checkbox
                                input(type="checkbox")
                                label= "Sun"
                            .ui.checkbox
                                input(type="checkbox")
                                label= "Mon"
                            .ui.checkbox
                                input(type="checkbox")
                                label= "Tue"
                            .ui.checkbox
                                input(type="checkbox")
                                label= "Wed"
                    .field
                        label= 'Locale timezone'
                        select.dropdown.form-control(name="timezone")
                            each timezone, index in timezones
                                - var selected = channel.timezone && channel.timezone.id == timezone.id
                                option(value=timezone.id, selected=selected)= timezone.label
                    .field
                        label= 'Start meeting (locale time)'
                        input.form-control(name="start", type="time", step="60", value=channel.start)
                    .field
                        label= 'Duration'
                        input.form-control(name="duration", type="number", step="5", value= channel.duration)
                    button.ui.button.fluid.positive(type="submit")= 'Save'
            .column
                h3.ui.header= "Questions"
                form#question.ui.form(method='post')
                    draggable(:list="questions", v-bind="dragOptions", handle=".icon.movable")
                        .field(v-for="(question, index) in questions")
                            label= "#{{ index + 1 }}"
                            .movable-input
                                .ui.icon.input
                                    input.form-control(v-bind:name="'questions[' + index + ']'", type="text", v-model="question.text", required, minlength=2)
                                    i.inverted.circular.trash.link.icon(v-on:click="remote(question)")
                                i(class="icon expand arrows alternate movable")
                        div
                    .ui.buttons
                        a.ui.button.fluid(href="#", v-on:click="add")= 'Add question'
                        button.ui.button.fluid.positive(type="submit", v-bind:disabled="questions.length === 0")= 'Save'

block append scripts
    script.
        var vm = new Vue({
            el: '#question',
            data: {
                questions: !{JSON.stringify(channel.questions)},
                dragOptions: {
                    animation: 200,
                }
            },
            created: function () {
                // `this` указывает на экземпляр vm
                console.log(this.questions)
            },
            methods: {
                add() {
                    this.questions.push({text: ""})
                },
                remote(question) {
                    this.questions.splice(this.questions.indexOf(question), 1)
                }
            }
        })